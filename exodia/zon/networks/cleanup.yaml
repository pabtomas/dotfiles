---

rules:
  - id: '{{ $rules.down }}'
    run:
      - endpoint: /networks
        method: GET
        register:
          id: down.networks.json
          query:
            filters: '{"label":{"exodia":{{ $project.id }}}}'
          errexit: false
          as: registerdownnetworks
      - endpoint: /networks/{id}
        method: DELETE
        from:
          id: remove.from.down.networks.json
          filter: '{{ $array := "" }}{{ range $registerdownnetworks }}{{ $array = print $array "{\"path\":{\"id\":\"" .Name "\"}}," }}{{ end }}{{ print "[" $array "]" | data.YAMLArray }}'
          errexit: false
          depends_on:
            - down.networks.json

...
