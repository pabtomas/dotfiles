---

rules:
  - id: '{{ $rules.down }}'
    run:
      - endpoint: /networks
        method: GET
        register:
          id: post.networks.json
          query:
            filters: '{"label":{"exodia":{{ $project.id }}}}'
          errexit: false
          as:
            id: registerpostnetworks
      - endpoint: /networks/{id}
        method: DELETE
        from:
          id: delete.from.post.networks.json
          filter: '{{ $array := "" }}{{ range $registerpostnetworks }}{{ $array = print $array "{\"path\":{\"id\":\"" .Name "\"}}," }}{{ end }}{{ print "[" $array "]" | data.YAMLArray }}'
          errexit: false
          depends_on:
            - post.networks.json

...
