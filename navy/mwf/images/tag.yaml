---

rule:
  id: '{{ $rules.up }}'
  run:
    - loop:
        endpoint: /images/{name}/tag
        method: POST
        from:
          - id: '{{ $dependencies.images.tag.alpine }}'
            query:
              repo: '{{ $alpine.image.local }}'
              tag: '{{ $alpine.tag }}'
            path:
              name: '{{ $alpine.image.source }}{{ $all.sep.tag }}{{ $alpine.tag }}'
            depends_on:
              - '{{ $dependencies.images.pull.alpine }}'
          - id: '{{ $dependencies.images.tag.bash }}'
            query:
              repo: '{{ $bash.image.local }}'
              tag: '{{ $bash.tag }}'
            path:
              name: '{{ $bash.image.source }}{{ $all.sep.tag }}{{ $bash.tag }}'
            depends_on:
              - '{{ $dependencies.images.pull.bash }}'
          - id: '{{ $dependencies.images.tag.buildkit }}'
            query:
              repo: '{{ $buildkit.image.local }}'
              tag: '{{ $buildkit.tag }}'
            path:
              name: '{{ $buildkit.image.source }}{{ $all.sep.tag }}{{ $buildkit.tag }}'
            depends_on:
              - '{{ $dependencies.images.pull.buildkit }}'
          - id: '{{ $dependencies.images.tag.docker }}'
            query:
              repo: '{{ $docker.image.local }}'
              tag: '{{ $docker.tag }}'
            path:
              name: '{{ $docker.image.source }}{{ $all.sep.tag }}{{ $docker.tag }}'
            depends_on:
              - '{{ $dependencies.images.pull.docker }}'
          - id: '{{ $dependencies.images.tag.registry }}'
            query:
              repo: '{{ $registry.image.local }}'
              tag: '{{ $registry.tag }}'
            path:
              name: '{{ $registry.image.source }}{{ $all.sep.tag }}{{ $registry.tag }}'
            depends_on:
              - '{{ $dependencies.images.pull.registry }}'
          - id: '{{ $dependencies.images.tag.socketproxy }}'
            query:
              repo: '{{ $socketproxy.linuxserver.image.local }}'
              tag: '{{ $socketproxy.linuxserver.tag }}'
            path:
              name: '{{ $socketproxy.linuxserver.image.source }}{{ $all.sep.tag }}{{ $socketproxy.linuxserver.tag }}'
            depends_on:
              - '{{ $dependencies.images.pull.socketproxy }}'

...
